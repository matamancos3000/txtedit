from pywinauto.application import Application
import time
from datetime import datetime

# ==============================
# CONFIGURACI√ìN
# ==============================

WINDOW_TITLE = "CAM30"         # Nombre EXACTO de la ventana
DELAY_BEFORE_MINIMIZE = 10     # Segundos antes de minimizar
DELAY_BEFORE_RESTORE = 10      # Segundos antes de restaurar
CYCLE_INTERVAL = 30            # Cada cu√°nto repetir el ciclo (segundos) ‚Üí aqu√≠ puedes poner 6 horas = 21600


# ==============================
# PROGRAMA
# ==============================

print(f"Buscando ventana '{WINDOW_TITLE}' cada ciclo de {CYCLE_INTERVAL} segundos.\n")

while True:
    try:
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        print(f"[{timestamp}] Intentando localizar la ventana...")

        # Intentar conectar
        app = Application(backend="uia").connect(title=WINDOW_TITLE)
        dlg = app.window(title=WINDOW_TITLE)

        print(f"‚úî Ventana encontrada: '{WINDOW_TITLE}'")

        # Esperar antes de minimizar
        print(f"Esperando {DELAY_BEFORE_MINIMIZE} segundos antes de minimizar...")
        time.sleep(DELAY_BEFORE_MINIMIZE)

        print("‚ûñ Minimizando ventana...")
        dlg.minimize()

        # Esperar antes de restaurar
        print(f"Esperando {DELAY_BEFORE_RESTORE} segundos antes de restaurar...")
        time.sleep(DELAY_BEFORE_RESTORE)

        print("üîÑ Restaurando ventana (sin traerla al frente)...")
        dlg.restore()

        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        print(f"[{timestamp}] Ciclo completado.\n")

    except Exception as e:
        print(f"‚ùå No se pudo acceder a la ventana: {e}")

    # Esperar siguiente ciclo
    print(f"‚è≥ Esperando {CYCLE_INTERVAL} segundos para el pr√≥ximo ciclo...\n")
    time.sleep(CYCLE_INTERVAL)
